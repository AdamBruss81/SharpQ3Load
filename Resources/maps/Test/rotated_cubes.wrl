#VRML V2.0 utf8 generated by Q3BSP 1.1 from maps/rotated_cubes
WorldInfo { title "maps/rotated_cubes" }

NavigationInfo { headlight TRUE avatarSize [0.25 1.3333 2 ]} 
#VRML V2.0 utf8

# q3effects.wrl V 1.0
# some Quake 3 shader effects emulation
# hg@x79.net
#
##### Effects Begin


#### global effects timer 
DEF	TIMER TimeSensor { loop	TRUE cycleInterval 1.0 }

# cycle through a list of texture
PROTO AnimMap
[
	eventIn	SFFloat set_fraction 
	field SFFloat frequency 1
	field MFNode textures [] 
	eventIn	SFTime set_time
]
{
	DEF SW Switch {	# not VRML 97, use Switch to select texture
		whichChoice	0
		choice IS textures
	}

	DEF S Script {
		
		eventIn	SFFloat set_fraction  IS set_fraction
		eventIn	SFTime set_time  IS set_time

		eventOut SFInt32 choice_changed  
		
		field SFFloat frequency IS frequency
		field MFNode textures IS textures

		url	"javascript:
		function set_fraction(f) 
		{

			f = f*frequency / textures.length;
			f-= Math.floor(f);
			f= f* textures.length;
			//print(f);
			choice_changed = f;
		}	
		function set_time(f) 
		{

			f = f*frequency / textures.length;
			f-= Math.floor(f);
			f= f* textures.length;
			//print(f);
			choice_changed = f;
		}	

		"

	}
	ROUTE  S.choice_changed	TO SW.whichChoice

}


# Contact Extension Node definitions 
EXTERNPROTO MultiTexture[
	exposedField SFBool materialColor
	exposedField SFBool materialAlpha
	exposedField MFString mode
	exposedField MFString type
	exposedField MFNode texture
	exposedField MFNode textureTransform
	exposedField MFInt32 textureOp
	exposedField SFColor color
	exposedField SFFloat alpha
	]
["urn:inet:blaxxun.com:node:MultiTexture","http://www.blaxxun.com/vrml/protos/nodes.wrl#MultiTexture","nodes.wrl#MultiTexture"]

EXTERNPROTO TextureCoordGen[
	exposedField SFString mode
	exposedField MFFloat parameter
	]
["urn:inet:blaxxun.com:node:TextureCoordGen","http://www.blaxxun.com/vrml/protos/nodes.wrl#TextureCoordGen","nodes.wrl#TextureCoordGen"]

EXTERNPROTO MultiTextureCoordinate[
	exposedField MFNode coord
	]
["urn:inet:blaxxun.com:node:MultiTextureCoordinate","http://www.blaxxun.com/vrml/protos/nodes.wrl#MultiTextureCoordinate","nodes.wrl#MultiTextureCoordinate"]

EXTERNPROTO DrawOp[
	exposedField MFInt32 op
	exposedField MFFloat args 
]
["urn:inet:blaxxun.com:node:DrawOp","http://www.blaxxun.com/vrml/protos/nodes.wrl#DrawOp","nodes.wrl#DrawOp"]

#tcmod scroll 0 2
#tcMod stretch sin 1.2 .8 0 1.5
#tcMod stretch sin 1.2 .8 0 1.5
#tcMod rotate 40
#tcMod scale 2 2
# tcMod turb 0 .1 0 .01

PROTO rgbgen [
	field SFFloat base 0
	field SFFloat amplitude 1
	field SFFloat phase	 0
	field SFFloat frequency 1

	eventIn	SFFloat set_fraction 
	eventOut SFColor color

]
{
	Script {

		eventIn	SFFloat set_fraction  IS set_fraction
		eventOut SFColor color IS color

		field SFFloat base IS base
		field SFFloat amplitude IS amplitude
		field SFFloat phase IS phase
		field SFFloat frequency	IS frequency

		directOutput TRUE

		url	"javascript:
		function rgbgen(f) {
			//<freq> 
			f*=frequency;
			f+=phase;

			// sine 
			y = base+amplitude*Math.sin(f*Math.PI*2);
			// triangle
			f= f-Math.floor(f);
			if (f<=0.5) f=f*2; else f = 1 - 2*(f-0.5);

			// saw sawtooth
			f=f;
			///Inversesawtooth
			//f=1.0-f;
			//Square
			//if (f<=0.5) f=1; else f = -1;
			//y=base+amplitude*f;
			color= new SFColor(y,y,y);
		}
		function set_fraction(f) 
		{
			rgbgen(f);
		}	

		"

	}

}

PROTO TcMod [

	field SFString mode ""

	field SFVec2f scale  1 1

	field SFFloat rotate 0
	field SFVec2f scroll 0 0

	field SFInt32 func -1
	field SFFloat base 0
	field SFFloat amplitude 1
	field SFFloat phase	 0
	field SFFloat frequency 1

	eventIn	SFFloat set_fraction 
	eventIn	SFTime set_time

]
{
	DEF TX TextureTransform {
	#	scale  IS scale
		center -0.5 -0.5
	}

	Script {
		directOutput TRUE
		field SFNode TX USE	TX 
		
		eventIn	SFFloat set_fraction  IS set_fraction
		eventIn	SFTime set_time  IS set_time


		field SFFloat angle IS rotate

		field SFVec2f scale IS scale

		field SFVec2f s IS scroll

		field SFInt32 func IS func
		field SFFloat base IS base
		field SFFloat amplitude IS amplitude
		field SFFloat phase IS phase
		field SFFloat frequency	IS frequency

		directOutput TRUE

		url	"javascript:
		// rotate <degrees per per second>
		function rotate(f) { 	TX.rotation = f * angle * Math.PI*2; }
		function scroll(f) 
		{ 
			 var x = s.x* f *scale.x;
			 //x = x-Math.floor(x);
			 var y = s.y* f *scale.y;
			 //y = y-Math.floor(y);

			 TX.translation.x=x;
			 TX.translation.y=y;

		}
		// stretch <func> <base> <amplitude> <phase> <frequency>
		
		function stretch(f) 
		{
			f*=frequency;
			f+=phase;
			f=f-Math.floor(f);
			
			if (func== 0) // sine 
				f = Math.sin(f*Math.PI*2);
			else if (func == 1) {// triangle
				if (f<=0.5) f=f*2; else f = 1 - 2*(f-0.5);
			} else if (func == 2) {// saw sawtooth
				f=f;
			} else if (func == 3) {///Inversesawtooth
				f=1.0-f;
			} else if (func == 4) {//Square
				if (f<=0.5) f=-1; else f = 1;
			}
			y=base+amplitude*f;
			TX.scale.x = y;
			TX.scale.y = y;
		}

		function set_fraction(f) 
		{
			if (angle!=0) rotate(f);
			if (func>=0) stretch(f);
			scroll(f);
		}	
		function set_time(f) 
		{
			TX.scale.x = 1.0/scale.x;
			TX.scale.y = 1.0/scale.y;

			if (angle!=0) rotate(f-Math.floor(f));
			if (func>=0) stretch(f);
			scroll(f-Browser.getWorldStartTime());
		}	
		"

	}

}
Switch {
	whichChoice	-1
	choice [
		DEF BLEND_ONE_ONE DrawOp { op [	  # equivalent TO ADD 
				1 0 # zwrite off
				2 4 # z-test le-equal 
				6 1 # blend enable 
				7 2 # src blend mode  ONE
				8 2 # dst blend mode  ONE
			]
		}
		DEF BLEND_RESET DrawOp { op [
				1 1   # zwrite on
				6 0   # blend enable off 
				7  6  # src blend mode
				8  5  # dst blend mode 
			]
		}
		# global Material Node
		DEF MAT Material {
			#diffuseColor 1 1 1 we have problems with lighting
			diffuseColor 0 0 0
			emissiveColor 0.3 0.3 0.3
		}

		DEF MAT-UNLIT Material {
			diffuseColor 0 0 0
			emissiveColor 0.5 0.5 0.5
		}


	]
}

## for global brightness control 
DEF SUNLIGHT DirectionalLight {
	color	1 1 1
	ambientIntensity	0.5
	intensity 0.5
	direction 1 1 1
	on FALSE
	
}

##### Effects End




Group {
children [
Shape {
appearance DEF A0 Appearance {
material USE MAT 
texture MultiTexture { materialColor TRUE texture [
DEF _T0 ImageTexture {
  url "textures/base_wall/concrete.jpg"
}
]}}
geometry  IndexedFaceSet {
	ccw FALSE creaseAngle 3.14
	coordIndex [
	0,1,2,-1,
	2,1,3,-1,
	4,5,6,-1,
	7,5,4,-1,
	8,9,10,-1,
	10,9,11,-1,
	12,13,14,-1,
	14,13,15,-1,
	16,17,18,-1,
	18,17,19,-1,
	20,21,22,-1,
	23,21,20,-1,
	24,25,26,-1,
	26,25,27,-1,
	28,29,30,-1,
	31,29,28,-1,
	32,33,34,-1,
	34,33,35,-1,
	36,37,38,-1,
	39,37,36,-1,
	40,41,42,-1,
	43,41,40,-1,
	44,45,46,-1,
	47,45,44,-1,
	48,49,50,-1,
	51,49,48,-1,
	52,53,54,-1,
	55,53,52,-1,
	56,57,58,-1,
	58,57,59,-1,
	60,61,62,-1,
	63,61,60,-1,
	64,65,66,-1,
	66,65,67,-1,
	68,69,70,-1,
	71,69,68,-1,
	72,73,74,-1,
	74,73,75,-1,
	76,77,78,-1,
	78,77,79,-1,
	80,81,82,-1,
	83,81,80,-1,
	84,85,86,-1,
	86,85,87,-1,
	88,89,90,-1,
	90,89,91,-1,
	92,93,94,-1,
	95,93,92,-1]
coord Coordinate { point [
	34.6 10.3111 35.9111,25.9556 18.9556 35.9111,34.6 10.3111 21.6889,25.9556 18.9556 21.6889,
	34.6 10.3111 21.6889,25.2444 0.955556 35.9111,34.6 10.3111 35.9111,25.2444 0.955556 21.6889,
	17.4222 -19.5556 -15.6444,17.4222 -19.5556 -9.95556,17.4222 -13.8667 -15.6444,17.4222 -13.8667 -9.95556,
	25.9556 18.9556 21.6889,16.6 9.6 21.6889,34.6 10.3111 21.6889,25.2444 0.955556 21.6889,
	25.9556 18.9556 35.9111,16.6 9.6 35.9111,25.9556 18.9556 21.6889,16.6 9.6 21.6889,
	34.6 10.3111 35.9111,16.6 9.6 35.9111,25.9556 18.9556 35.9111,25.2444 0.955556 35.9111,
	16.6 9.6 21.6889,16.6 9.6 35.9111,25.2444 0.955556 21.6889,25.2444 0.955556 35.9111,
	17.4222 -13.8667 -15.6444,11.7333 -19.5556 -15.6444,17.4222 -19.5556 -15.6444,11.7333 -13.8667 -15.6444,
	17.4222 -13.8667 -9.95556,11.7333 -13.8667 -9.95556,17.4222 -13.8667 -15.6444,11.7333 -13.8667 -15.6444,
	17.4222 -13.8667 -9.95556,11.7333 -19.5556 -9.95556,11.7333 -13.8667 -9.95556,17.4222 -19.5556 -9.95556,
	11.7333 -13.8667 -15.6444,11.7333 -19.5556 -9.95556,11.7333 -19.5556 -15.6444,11.7333 -13.8667 -9.95556,
	17.4222 -19.5556 -15.6444,11.7333 -19.5556 -9.95556,17.4222 -19.5556 -9.95556,11.7333 -19.5556 -15.6444,
	8.68056 -26.2389 17.7361,-2.48611 -30.5444 37.8333,-2.48611 -18.3444 25.6333,8.68056 -38.4417 29.9389,
	13.3972 23.775 -29.7583,-2.55833 51.4083 -28.3139,5.78056 36.9639 -44.9917,5.05833 38.2167 -13.0833,
	-3.00833 -34.5056 9.46944,-3.00833 -46.7083 21.6722,8.68056 -26.2389 17.7361,8.68056 -38.4417 29.9389,
	8.68056 -26.2389 17.7361,-14.175 -26.6111 17.3667,-3.01111 -34.5056 9.46944,-2.48611 -18.3444 25.6333,
	-14.175 -26.6111 17.3667,-14.175 -38.8111 29.5667,-3.01111 -34.5056 9.46944,-3.01111 -46.7083 21.6722,
	-2.48611 -18.3444 25.6333,-14.175 -38.8111 29.5667,-14.175 -26.6111 17.3667,-2.48611 -30.5444 37.8333,
	-3.00833 -46.7083 21.6722,-14.175 -38.8111 29.5667,8.68056 -38.4417 29.9389,-2.48611 -30.5444 37.8333,
	5.78056 36.9639 -44.9917,-14.7694 25.1 -44.9917,13.3972 23.775 -29.7583,-7.15278 11.9083 -29.7583,
	13.3972 23.775 -29.7583,-15.4917 26.35 -13.0833,5.05833 38.2167 -13.0833,-7.15278 11.9083 -29.7583,
	-2.55833 51.4083 -28.3139,-23.1083 39.5417 -28.3139,5.78056 36.9667 -44.9917,-14.7694 25.1 -44.9917,
	-14.7694 25.1 -44.9917,-23.1083 39.5417 -28.3139,-7.15278 11.9083 -29.7583,-15.4917 26.35 -13.0833,
	5.05833 38.2167 -13.0833,-23.1083 39.5417 -28.3139,-2.55833 51.4083 -28.3139,-15.4917 26.35 -13.0833]}
texCoord  MultiTextureCoordinate { coord [
		TextureCoordinate { point [
	2.16406 -1.625,-0.875 -1.625,2.16406 3.375,-0.875 3.375,
	2.16406 3.375,-1.125 -1.625,2.16406 -1.625,-1.125 3.375,
	1.5 -0.875,-0.5 -0.875,1.5 1.125,-0.5 1.125,
	0.125 3.66406,-3.16406 0.375,3.16406 0.625,-0.125 -2.66406,
	2.125 -1.625,-1.16406 -1.625,2.125 3.375,-1.16406 3.375,
	3.16406 0.625,-3.16406 0.375,0.125 3.66406,-0.125 -2.66406,
	-1.16406 3.375,-1.16406 -1.625,1.875 3.375,1.875 -1.625,
	1.125 1.125,-0.875 -0.875,1.125 -0.875,-0.875 1.125,
	1.125 -0.5,-0.875 -0.5,1.125 1.5,-0.875 1.5,
	1.125 1.125,-0.875 -0.875,-0.875 1.125,1.125 -0.875,
	1.5 1.125,-0.5 -0.875,1.5 -0.875,-0.5 1.125,
	1.125 1.5,-0.875 -0.5,1.125 -0.5,-0.875 1.5,
	3.76465 0.775391,-3.30078 -0.738281,0.988281 3.55078,-0.525391 -3.51465,
	0.461914 -4.6416,-0.0458984 5.07324,5.81738 -0.00488281,-5.40039 0.435547,
	3.6709 0.869141,-0.619141 -3.4209,0.764648 3.77539,-3.52539 -0.514648,
	4.05176 0.764648,-3.9834 0.894531,-0.0585938 3.6709,0.125977 -2.01172,
	0.894531 3.64453,-3.39453 -0.644531,3.6709 0.869141,-0.619141 -3.4209,
	0.988281 4.55078,-0.394531 -2.64453,3.89453 1.64453,-3.30078 0.261719,
	-0.0576172 3.38086,-3.9834 0.605469,4.05176 0.474609,0.125977 -2.30078,
	3.03223 4.99512,-4.19238 0.824219,5.70996 0.358398,-1.51465 -3.81348,
	5.70996 0.358398,-4.44629 1.26367,2.77832 5.43555,-1.51465 -3.81348,
	3.10059 5.07324,-4.12402 0.901367,6.03223 -0.00390625,-1.19238 -4.17578,
	5.81738 -0.175781,-0.0458984 4.90137,0.461914 -4.81348,-5.40039 0.263672,
	5.77832 0.435547,-4.12402 0.901367,3.10059 5.07324,-1.44629 -3.73633]}
	TextureCoordinate { point [
	2.16406 -1.625,-0.875 -1.625,2.16406 3.375,-0.875 3.375,
	2.16406 3.375,-1.125 -1.625,2.16406 -1.625,-1.125 3.375,
	1.5 -0.875,-0.5 -0.875,1.5 1.125,-0.5 1.125,
	0.125 3.66406,-3.16406 0.375,3.16406 0.625,-0.125 -2.66406,
	2.125 -1.625,-1.16406 -1.625,2.125 3.375,-1.16406 3.375,
	3.16406 0.625,-3.16406 0.375,0.125 3.66406,-0.125 -2.66406,
	-1.16406 3.375,-1.16406 -1.625,1.875 3.375,1.875 -1.625,
	1.125 1.125,-0.875 -0.875,1.125 -0.875,-0.875 1.125,
	1.125 -0.5,-0.875 -0.5,1.125 1.5,-0.875 1.5,
	1.125 1.125,-0.875 -0.875,-0.875 1.125,1.125 -0.875,
	1.5 1.125,-0.5 -0.875,1.5 -0.875,-0.5 1.125,
	1.125 1.5,-0.875 -0.5,1.125 -0.5,-0.875 1.5,
	3.76465 0.775391,-3.30078 -0.738281,0.988281 3.55078,-0.525391 -3.51465,
	0.461914 -4.6416,-0.0458984 5.07324,5.81738 -0.00488281,-5.40039 0.435547,
	3.6709 0.869141,-0.619141 -3.4209,0.764648 3.77539,-3.52539 -0.514648,
	4.05176 0.764648,-3.9834 0.894531,-0.0585938 3.6709,0.125977 -2.01172,
	0.894531 3.64453,-3.39453 -0.644531,3.6709 0.869141,-0.619141 -3.4209,
	0.988281 4.55078,-0.394531 -2.64453,3.89453 1.64453,-3.30078 0.261719,
	-0.0576172 3.38086,-3.9834 0.605469,4.05176 0.474609,0.125977 -2.30078,
	3.03223 4.99512,-4.19238 0.824219,5.70996 0.358398,-1.51465 -3.81348,
	5.70996 0.358398,-4.44629 1.26367,2.77832 5.43555,-1.51465 -3.81348,
	3.10059 5.07324,-4.12402 0.901367,6.03223 -0.00390625,-1.19238 -4.17578,
	5.81738 -0.175781,-0.0458984 4.90137,0.461914 -4.81348,-5.40039 0.263672,
	5.77832 0.435547,-4.12402 0.901367,3.10059 5.07324,-1.44629 -3.73633	]}
]}
	color Color { color [
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,
	1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000,1.000 1.000 1.000]}
  }
}
]}
DEF Entities Group {
children [
]}

DEF BoundingBoxes {
version 1
count 58
numsides 6
[26
3,7,12,13
]
[27
0,1,2,3,6,7,8,9
]
[28
1,6,8,9
]
[32
2,3,11,13
]
[33
0,1,2,3,8,10,11
]
[34
0,1,8,10
]
[49
4,5,14,15,18,19,22,23
]
[50
4,5,14,15,16,17,18,19
]
[62
7,12,13
]
[63
6,7,8,9,12,13
]
[68
11,13
]
[69
8,9,10,11,12,13
]
[76
26,38,39
]
[77
26,38,42,43
]
[82
26,27,38,39,40,41
]
[83
26,27
]
[85
14,15,18,19,20,21,22,23
]
[86
15,16,17,18,20,21
]
[88
27,40
]
[89
27,40
]
[96
25,28,29
]
[97
24,25,28,29,30,31
]
[102
25,29,36,37
]
[103
25
]
[111
39
]
[112
38,39,43
]
[113
26,38,42,43
]
[117
39,41
]
[118
39,40,41
]
[119
26,27,42,46,47
]
[124
40,47
]
[125
27,40,46,47
]
[126
28,30,32,33
]
[132
28,29,30,32,33,36
]
[133
24,25,28,30,31
]
[138
24,25,29,35,36,37
]
[139
24,25,31,34,35
]
[147
39,44
]
[148
38,39,43,44
]
[149
42,43
]
[153
39,41,44,45
]
[154
40,41,44,45,47
]
[155
42,46,47
]
[160
40,41,45,47
]
[161
47
]
[162
30,32
]
[168
30,32,33,34,36
]
[169
30,31,32,34
]
[174
32,33,34,35,36,37
]
[175
31,34,35
]
[184
38,39,43,44
]
[185
42,43,44
]
[190
44,45,47
]
[191
42,43,44,45,46,47
]
[196
40,41,45,47
]
[204
32,34
]
[205
30,31,32,34
]
[210
32,33,34,35,36,37
]
}